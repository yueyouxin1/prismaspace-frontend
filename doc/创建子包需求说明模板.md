# 创建子包需求说明模板

> 用途：用于在 `prismaspace-frontend` Monorepo 中发起“新增子包”需求时，统一目标、边界、交付与验收标准。  
> 适用：`packages/*` 下所有新建能力包（UI、业务、工具、基础设施）。

---

## 0. 文档信息

- 需求名称：`[子包名称/需求简称]`
- 目标落地位置：`[当前项目路径]`

---

## 1. 项目约束文档（强制遵循）

以下文档是实现与验收的上位约束，冲突时优先按这些文档执行：

- `README.md`（仓库根目录）：统一架构白皮书与领域模型
- `prismaspace-frontend/README.md`（前端根目录）：前端对齐后端执行手册
- `prismaspace-frontend/doc/prisma-space-ui.md`：UI 美学规范（全局项目视野）
- `prismaspace-frontend/doc/prisma-space-pages-ui.md`：UI 美学规范（细节与模块）
- `prismaspace-frontend/doc/prisma-space-runtime.md`：资源运行时面板前端架构指导
- `prismaspace-frontend/doc/ui-development-guidelines.md`：UI 组件选型与兜底路径
- `prismaspace-frontend/doc/Vue通用架构与开发规范指南.md`：Vue 工程结构与编码规范

---

## 2. 需求背景与目标

### 2.1 背景

`[说明当前业务问题、重复建设点、现有方案不足]`

### 2.2 目标

- 目标 1：`[例如：沉淀可复用能力，避免项目内重复实现]`
- 目标 2：`[例如：统一 API/交互范式，降低接入成本]`
- 目标 3：`[例如：提供可运行 Demo，保证可验证交付]`

### 2.3 非目标（明确不做）

- `[]`
- `[]`

---

## 3. 子包定位与分层归属

### 3.1 包基础信息

- 子包目录：`packages/[pkg-name]`
- 包名：`@repo/[pkg-name]`
- 包类型：`[UI组件包/业务能力包/工具包/基础层包]`
- 目标消费方：`[apps/studio-web / 其他 packages]`

### 3.2 分层归属说明

- 归属层：`[common/generator/ui-reka/ui-shadcn/ui-ai-elements/其他]`
- 归属理由：`[为什么放在这一层而不是别的层]`

### 3.3 依赖边界（必须填写）

- 允许依赖：`[列出可依赖包]`
- 禁止依赖：`[列出禁止跨层依赖]`
- 是否涉及 UI 分层链路：`[是/否]`
- 若涉及 UI 分层，是否满足方向：`ui-ai-elements -> ui-shadcn -> ui-reka`：`[是/否/不适用]`

### 3.4 导入方式约束

- 应用层使用方式：仅通过 `@repo/*` 导入
- 禁止事项：禁止跨包相对路径直连源码内部实现
- 对外暴露入口：`src/index.ts`（或 exports 子路径）

---

## 4. 需求范围

### 4.1 In Scope（本次范围）

1. `[功能项 A]`
2. `[功能项 B]`
3. `[功能项 C]`

### 4.2 Out of Scope（不在本次范围）

1. `[后续迭代项 A]`
2. `[不做项 B]`

---

## 5. 详细需求清单（按优先级）

> 建议用 `P0/P1/P2` 标注优先级；每条需求必须可测试、可验收。

| 编号 | 优先级 | 需求描述 | 输入/触发 | 期望输出/行为 | 验收标准 |
|---|---|---|---|---|---|
| R-01 | P0 | `[示例：支持 schema 驱动渲染]` | `[输入条件]` | `[行为结果]` | `[可验证标准]` |
| R-02 | P0 | `[]` | `[]` | `[]` | `[]` |
| R-03 | P1 | `[]` | `[]` | `[]` | `[]` |

---

## 6. UI 与交互约束（UI 相关子包必填）

### 6.1 组件选型顺序（强制）

1. 优先 `@repo/ui-shadcn`（通用/专业场景）
2. 智能场景优先 `@repo/ui-ai-elements`
3. 无覆盖时按顺序评估：`@repo/ui-reka` -> `tailwindcss` -> 原生 CSS

### 6.2 风格一致性要求

- 保持现有设计体系一致（色板、圆角、阴影、排版、状态反馈）
- 兜底实现仅补齐缺口，避免过度抽象
- 新增大组件前，必须检索参考实现：
  - `reference_example\shadcn-vue-dev\deprecated\www`
  - `reference_example\ai-elements-vue-main\apps\www`

### 6.3 交互状态覆盖

- 默认态、Hover、Focus、Active、Disabled
- Loading、Empty、Error
- 边界输入与异常状态

---

## 7. 技术方案与工程改动

### 7.1 目录与文件规划

```txt
packages/[pkg-name]/
├── src/
│   ├── index.ts
│   ├── [modules...]
│   └── [types...]
├── package.json
└── README.md
```

### 7.2 package.json 关键项

- `name`：`@repo/[pkg-name]`
- `type`：`module`
- `exports`：`[明确根导出与子路径导出]`

### 7.3 配置变更（按需）

若应用层要直接导入该包，需同步更新：

- `vite.config.ts`（alias）
- `tsconfig.json`（paths）
- `tsconfig.app.json`（paths + include）

### 7.4 API 与类型设计

- 对外 API 清单：`[函数/组件/类型名]`
- 稳定性级别：`[稳定/实验]`
- Break Change 策略：`[如何兼容或升级]`

---

## 8. Demo 交付方案（强制）

### 8.1 Demo 实现位置

- 目录：`apps/studio-web/src/components/demo-playground/[demo-name]/`
- 主入口组件：`[XxxDemo.vue]`

### 8.2 Demo 注册

在 `apps/studio-web/src/data/component-demos.ts` 增加：

- `slug`
- `title`
- `description`
- `tags`
- `component`

### 8.3 Demo 验证点

- 核心功能路径可完整走通
- 关键状态可视化验证（至少 3 类）
- 边界行为可复现与回归

---

## 9. 测试与验证

### 9.1 必跑命令

```bash
pnpm check:aliases
pnpm build
```

### 9.2 建议验证

```bash
pnpm dev
```

- 在 `/components` 可见 Demo 入口
- 在 `/components/:slug` 可完成交互验证

### 9.3 测试清单

- 单元测试：`[是否新增，覆盖点]`
- 集成测试：`[是否新增，覆盖点]`
- 手工测试：`[场景清单]`

---

## 10. 交付物清单（DoD 输入）

- `packages/[pkg-name]/src` 实现代码
- `packages/[pkg-name]/package.json`
- `packages/[pkg-name]/README.md`
- Playground Demo（含注册）
- 需求文档与技术说明更新

---

## 11. 风险、依赖与回滚

### 11.1 风险清单

| 风险 | 影响 | 概率 | 应对策略 |
|---|---|---|---|
| `[示例：跨层依赖污染]` | 高 | 中 | `[在 PR 阶段做边界检查]` |
| `[]` | `[]` | `[]` | `[]` |

### 11.2 外部依赖

- `[第三方库/接口/团队协作依赖]`

### 11.3 回滚策略

- `[出现阻塞时的降级或回退方案]`

---

## 12. 里程碑计划

| 里程碑 | 产出 | 负责人 | 截止日期 |
|---|---|---|---|
| M1 需求冻结 | 需求评审通过 | `[]` | `[]` |
| M2 开发完成 | 包功能 + Demo 可运行 | `[]` | `[]` |
| M3 验收上线 | 通过验收清单 | `[]` | `[]` |

---

## 13. 最终验收清单（DoD）

- [ ] 分层职责清晰，包定位合理
- [ ] 导入边界合规（无跨包相对路径污染）
- [ ] 对外导出完整且仅暴露必要能力
- [ ] Demo 已接入统一 Playground 并可访问
- [ ] `pnpm check:aliases` 通过
- [ ] `pnpm build` 通过
- [ ] 包 README 已补齐（定位/导出/Demo slug）
- [ ] 相关文档已更新

---

## 14. PR 自检清单

- [ ] 变更仅覆盖本需求范围，无无关修改
- [ ] 命名、目录、导出符合仓库规范
- [ ] UI 实现遵循选型优先级与风格一致性
- [ ] 关键风险已在 PR 描述中说明并给出应对
- [ ] 已附带验证方式与结果说明

---

## 15. 附录（可选）

### 15.1 参考资料

- `[设计稿/竞品/技术调研]`

### 15.2 术语表

- `[术语A]`：`[定义]`
- `[术语B]`：`[定义]`

